{
  "cells": [
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "view-in-github",
        "colab_type": "text"
      },
      "source": [
        "<a href=\"https://colab.research.google.com/github/Joayo0120/RC-AIStudy/blob/main/Uproad%20Joayo's%20ANN\" target=\"_parent\"><img src=\"https://colab.research.google.com/assets/colab-badge.svg\" alt=\"Open In Colab\"/></a>"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "aW1x4tMPC9cJ"
      },
      "outputs": [],
      "source": [
        "import torch\n",
        "import pandas as pd\n",
        "import numpy as np\n",
        "import random\n",
        "import os\n",
        "import scipy.special"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "3dSR9chlC1Qd"
      },
      "source": [
        "## Load Data & Pre-Processing"
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "import kagglehub\n",
        "\n",
        "# Download latest version\n",
        "path = kagglehub.dataset_download(\"yashpaloswal/ann-car-sales-price-prediction\")\n",
        "\n",
        "print(\"Path to dataset files:\", path)"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "J6HVY9lqnd9A",
        "outputId": "b032669c-6f80-446a-dff9-5520bdf54e7c"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Using Colab cache for faster access to the 'ann-car-sales-price-prediction' dataset.\n",
            "Path to dataset files: /kaggle/input/ann-car-sales-price-prediction\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "from sklearn.model_selection import train_test_split\n",
        "import os\n",
        "\n",
        "# 전체 데이터 읽기 (파일 경로와 인코딩 지정)\n",
        "df = pd.read_csv(os.path.join(path, 'car_purchasing.csv'), encoding='latin1')\n",
        "\n",
        "# train / test로 나누기 (예: 8:2)\n",
        "train, test = train_test_split(df, test_size=0.2, random_state=42)\n",
        "\n",
        "train.head()"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 365
        },
        "id": "fhFr2QEQlPYP",
        "outputId": "6f0f51f4-db86-429b-858f-c990b195cf9e"
      },
      "execution_count": null,
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "            customer name                     customer e-mail  \\\n",
              "249    Wilma L. Stevenson      non.vestibulum@consectetuer.ca   \n",
              "433               Madeson             libero.et@Crasdictum.ca   \n",
              "19            Athena Wolf  volutpat.Nulla.facilisis@primis.ca   \n",
              "322  Livingston, Blaze Y.      montes.nascetur@liberoet.co.uk   \n",
              "332      Irwin, Dillon J.                 arcu@dictummiac.edu   \n",
              "\n",
              "                   country  gender        age  annual Salary  \\\n",
              "249  Sao Tome and Principe       0  36.117247    70334.42787   \n",
              "433       Christmas Island       1  39.814817    56086.45033   \n",
              "19                    Iraq       0  58.741842    55368.23716   \n",
              "322                 Serbia       0  60.180119    58837.97088   \n",
              "332                Tokelau       0  31.244838    41361.95045   \n",
              "\n",
              "     credit card debt    net worth  car purchase amount  \n",
              "249       9823.218967  632600.4718          46135.27233  \n",
              "433       6588.606462  228388.5491          29519.56184  \n",
              "19       13272.946470  566022.1306          54827.52403  \n",
              "322      12788.815730  622324.7499          59625.02618  \n",
              "332      10755.508420  615720.0425          25252.93221  "
            ],
            "text/html": [
              "\n",
              "  <div id=\"df-629135d9-23e8-4a1c-b5ad-98024a2ab265\" class=\"colab-df-container\">\n",
              "    <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>customer name</th>\n",
              "      <th>customer e-mail</th>\n",
              "      <th>country</th>\n",
              "      <th>gender</th>\n",
              "      <th>age</th>\n",
              "      <th>annual Salary</th>\n",
              "      <th>credit card debt</th>\n",
              "      <th>net worth</th>\n",
              "      <th>car purchase amount</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>249</th>\n",
              "      <td>Wilma L. Stevenson</td>\n",
              "      <td>non.vestibulum@consectetuer.ca</td>\n",
              "      <td>Sao Tome and Principe</td>\n",
              "      <td>0</td>\n",
              "      <td>36.117247</td>\n",
              "      <td>70334.42787</td>\n",
              "      <td>9823.218967</td>\n",
              "      <td>632600.4718</td>\n",
              "      <td>46135.27233</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>433</th>\n",
              "      <td>Madeson</td>\n",
              "      <td>libero.et@Crasdictum.ca</td>\n",
              "      <td>Christmas Island</td>\n",
              "      <td>1</td>\n",
              "      <td>39.814817</td>\n",
              "      <td>56086.45033</td>\n",
              "      <td>6588.606462</td>\n",
              "      <td>228388.5491</td>\n",
              "      <td>29519.56184</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>19</th>\n",
              "      <td>Athena Wolf</td>\n",
              "      <td>volutpat.Nulla.facilisis@primis.ca</td>\n",
              "      <td>Iraq</td>\n",
              "      <td>0</td>\n",
              "      <td>58.741842</td>\n",
              "      <td>55368.23716</td>\n",
              "      <td>13272.946470</td>\n",
              "      <td>566022.1306</td>\n",
              "      <td>54827.52403</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>322</th>\n",
              "      <td>Livingston, Blaze Y.</td>\n",
              "      <td>montes.nascetur@liberoet.co.uk</td>\n",
              "      <td>Serbia</td>\n",
              "      <td>0</td>\n",
              "      <td>60.180119</td>\n",
              "      <td>58837.97088</td>\n",
              "      <td>12788.815730</td>\n",
              "      <td>622324.7499</td>\n",
              "      <td>59625.02618</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>332</th>\n",
              "      <td>Irwin, Dillon J.</td>\n",
              "      <td>arcu@dictummiac.edu</td>\n",
              "      <td>Tokelau</td>\n",
              "      <td>0</td>\n",
              "      <td>31.244838</td>\n",
              "      <td>41361.95045</td>\n",
              "      <td>10755.508420</td>\n",
              "      <td>615720.0425</td>\n",
              "      <td>25252.93221</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "</div>\n",
              "    <div class=\"colab-df-buttons\">\n",
              "\n",
              "  <div class=\"colab-df-container\">\n",
              "    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-629135d9-23e8-4a1c-b5ad-98024a2ab265')\"\n",
              "            title=\"Convert this dataframe to an interactive table.\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n",
              "    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n",
              "  </svg>\n",
              "    </button>\n",
              "\n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    .colab-df-buttons div {\n",
              "      margin-bottom: 4px;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "    <script>\n",
              "      const buttonEl =\n",
              "        document.querySelector('#df-629135d9-23e8-4a1c-b5ad-98024a2ab265 button.colab-df-convert');\n",
              "      buttonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "      async function convertToInteractive(key) {\n",
              "        const element = document.querySelector('#df-629135d9-23e8-4a1c-b5ad-98024a2ab265');\n",
              "        const dataTable =\n",
              "          await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                    [key], {});\n",
              "        if (!dataTable) return;\n",
              "\n",
              "        const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "          + ' to learn more about interactive tables.';\n",
              "        element.innerHTML = '';\n",
              "        dataTable['output_type'] = 'display_data';\n",
              "        await google.colab.output.renderOutput(dataTable, element);\n",
              "        const docLink = document.createElement('div');\n",
              "        docLink.innerHTML = docLinkHtml;\n",
              "        element.appendChild(docLink);\n",
              "      }\n",
              "    </script>\n",
              "  </div>\n",
              "\n",
              "\n",
              "    <div id=\"df-aef70214-fd91-448d-b84c-3735bf85b6b1\">\n",
              "      <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-aef70214-fd91-448d-b84c-3735bf85b6b1')\"\n",
              "                title=\"Suggest charts\"\n",
              "                style=\"display:none;\">\n",
              "\n",
              "<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "     width=\"24px\">\n",
              "    <g>\n",
              "        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n",
              "    </g>\n",
              "</svg>\n",
              "      </button>\n",
              "\n",
              "<style>\n",
              "  .colab-df-quickchart {\n",
              "      --bg-color: #E8F0FE;\n",
              "      --fill-color: #1967D2;\n",
              "      --hover-bg-color: #E2EBFA;\n",
              "      --hover-fill-color: #174EA6;\n",
              "      --disabled-fill-color: #AAA;\n",
              "      --disabled-bg-color: #DDD;\n",
              "  }\n",
              "\n",
              "  [theme=dark] .colab-df-quickchart {\n",
              "      --bg-color: #3B4455;\n",
              "      --fill-color: #D2E3FC;\n",
              "      --hover-bg-color: #434B5C;\n",
              "      --hover-fill-color: #FFFFFF;\n",
              "      --disabled-bg-color: #3B4455;\n",
              "      --disabled-fill-color: #666;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart {\n",
              "    background-color: var(--bg-color);\n",
              "    border: none;\n",
              "    border-radius: 50%;\n",
              "    cursor: pointer;\n",
              "    display: none;\n",
              "    fill: var(--fill-color);\n",
              "    height: 32px;\n",
              "    padding: 0;\n",
              "    width: 32px;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart:hover {\n",
              "    background-color: var(--hover-bg-color);\n",
              "    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "    fill: var(--button-hover-fill-color);\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart-complete:disabled,\n",
              "  .colab-df-quickchart-complete:disabled:hover {\n",
              "    background-color: var(--disabled-bg-color);\n",
              "    fill: var(--disabled-fill-color);\n",
              "    box-shadow: none;\n",
              "  }\n",
              "\n",
              "  .colab-df-spinner {\n",
              "    border: 2px solid var(--fill-color);\n",
              "    border-color: transparent;\n",
              "    border-bottom-color: var(--fill-color);\n",
              "    animation:\n",
              "      spin 1s steps(1) infinite;\n",
              "  }\n",
              "\n",
              "  @keyframes spin {\n",
              "    0% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "      border-left-color: var(--fill-color);\n",
              "    }\n",
              "    20% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    30% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    40% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    60% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    80% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "    90% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "  }\n",
              "</style>\n",
              "\n",
              "      <script>\n",
              "        async function quickchart(key) {\n",
              "          const quickchartButtonEl =\n",
              "            document.querySelector('#' + key + ' button');\n",
              "          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n",
              "          quickchartButtonEl.classList.add('colab-df-spinner');\n",
              "          try {\n",
              "            const charts = await google.colab.kernel.invokeFunction(\n",
              "                'suggestCharts', [key], {});\n",
              "          } catch (error) {\n",
              "            console.error('Error during call to suggestCharts:', error);\n",
              "          }\n",
              "          quickchartButtonEl.classList.remove('colab-df-spinner');\n",
              "          quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n",
              "        }\n",
              "        (() => {\n",
              "          let quickchartButtonEl =\n",
              "            document.querySelector('#df-aef70214-fd91-448d-b84c-3735bf85b6b1 button');\n",
              "          quickchartButtonEl.style.display =\n",
              "            google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "        })();\n",
              "      </script>\n",
              "    </div>\n",
              "\n",
              "    </div>\n",
              "  </div>\n"
            ],
            "application/vnd.google.colaboratory.intrinsic+json": {
              "type": "dataframe",
              "variable_name": "train",
              "summary": "{\n  \"name\": \"train\",\n  \"rows\": 400,\n  \"fields\": [\n    {\n      \"column\": \"customer name\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 399,\n        \"samples\": [\n          \"Courtney\",\n          \"Schultz, Lee I.\",\n          \"Mechelle W. Stanton\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"customer e-mail\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 400,\n        \"samples\": [\n          \"sapien.imperdiet.ornare@vitaeerat.edu\",\n          \"sit.amet@orci.ca\",\n          \"Pellentesque.habitant@auctorquistristique.org\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"country\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 194,\n        \"samples\": [\n          \"Puerto Rico\",\n          \"Saint Barth\\u00e9lemy\",\n          \"Namibia\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"gender\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 0,\n        \"min\": 0,\n        \"max\": 1,\n        \"num_unique_values\": 2,\n        \"samples\": [\n          1,\n          0\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"age\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 8.047784714737292,\n        \"min\": 20.0,\n        \"max\": 69.56930586,\n        \"num_unique_values\": 400,\n        \"samples\": [\n          34.49805732,\n          51.03125632\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"annual Salary\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 11903.253119585937,\n        \"min\": 20000.0,\n        \"max\": 100000.0,\n        \"num_unique_values\": 400,\n        \"samples\": [\n          77206.48386,\n          83626.30783\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"credit card debt\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 3491.8115873980405,\n        \"min\": 100.0,\n        \"max\": 20000.0,\n        \"num_unique_values\": 400,\n        \"samples\": [\n          8493.098575,\n          8458.749819\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"net worth\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 175574.61340633355,\n        \"min\": 27888.74525,\n        \"max\": 1000000.0,\n        \"num_unique_values\": 400,\n        \"samples\": [\n          411070.4828,\n          167031.5554\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"car purchase amount\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 10850.80034459416,\n        \"min\": 9000.0,\n        \"max\": 80000.0,\n        \"num_unique_values\": 400,\n        \"samples\": [\n          42213.69644,\n          52665.36511\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}"
            }
          },
          "metadata": {},
          "execution_count": 17
        }
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "UJuQByt1C7c4"
      },
      "outputs": [],
      "source": [
        "train['gender'] = train['gender'].map({'F':0, \"M\": 1})\n",
        "test['gender'] = test['gender'].map({'F':0, \"M\": 1})\n",
        "\n",
        "train['subscription_type'] = train['subscription_type'].map({'member' : 0, 'plus' : 1, 'vip' : 2})\n",
        "test['subscription_type'] = test['subscription_type'].map({'member' : 0, 'plus' : 1, 'vip' : 2})"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "NU4wesGjDDeE",
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "outputId": "166282f3-bb82-4e7d-fcc2-0e5f170a7b6c"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "(400, 216) (100, 216)\n"
          ]
        }
      ],
      "source": [
        "# 1. X에서 customer name / customer e-mail / 타깃 컬럼 제거\n",
        "x_train = train.drop(columns=['customer name', 'customer e-mail', 'car purchase amount'])\n",
        "x_test  = test.drop(columns=['customer name', 'customer e-mail', 'car purchase amount'])\n",
        "\n",
        "# 2. train + test를 합쳐서 범주형(object) 인코딩\n",
        "all_x = pd.concat([x_train, x_test], axis=0)\n",
        "\n",
        "# 문자형(범주형) 컬럼들 찾기\n",
        "cat_cols = all_x.select_dtypes(include=['object']).columns\n",
        "\n",
        "# 원-핫 인코딩\n",
        "all_x_encoded = pd.get_dummies(all_x, columns=cat_cols)\n",
        "\n",
        "# 다시 train / test로 나누기\n",
        "x_train = all_x_encoded.iloc[:len(train)].reset_index(drop=True)\n",
        "x_test  = all_x_encoded.iloc[len(train):].reset_index(drop=True)\n",
        "\n",
        "# 3. y 분리 + 텐서 + 원-핫 (클래스 3개라고 가정)\n",
        "y_train = train['car purchase amount']          # 실제 타깃 컬럼 이름으로 바꾸기\n",
        "y_train_tensor = torch.tensor(y_train.values, dtype=torch.long)\n",
        "#y_train_onehot = torch.nn.functional.one_hot(y_train_tensor, num_classes=3)\n",
        "\n",
        "print(x_train.shape, x_test.shape)\n",
        "#print(y_train_onehot)\n"
      ]
    },
    {
      "cell_type": "markdown",
      "source": [],
      "metadata": {
        "id": "-I932CGDuNK8"
      }
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 290
        },
        "id": "9esaGlZL3JE_",
        "outputId": "cdb14b7e-772f-40d6-d605-255f526f74f1"
      },
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "   gender        age  annual Salary  credit card debt    net worth  \\\n",
              "0       0  36.117247    70334.42787       9823.218967  632600.4718   \n",
              "1       1  39.814817    56086.45033       6588.606462  228388.5491   \n",
              "2       0  58.741842    55368.23716      13272.946470  566022.1306   \n",
              "3       0  60.180119    58837.97088      12788.815730  622324.7499   \n",
              "4       0  31.244838    41361.95045      10755.508420  615720.0425   \n",
              "\n",
              "   country_Afghanistan  country_Algeria  country_American Samoa  \\\n",
              "0                False            False                   False   \n",
              "1                False            False                   False   \n",
              "2                False            False                   False   \n",
              "3                False            False                   False   \n",
              "4                False            False                   False   \n",
              "\n",
              "   country_Andorra  country_Angola  ...  country_Venezuela  country_Viet Nam  \\\n",
              "0            False           False  ...              False             False   \n",
              "1            False           False  ...              False             False   \n",
              "2            False           False  ...              False             False   \n",
              "3            False           False  ...              False             False   \n",
              "4            False           False  ...              False             False   \n",
              "\n",
              "   country_Virgin Islands, British  country_Virgin Islands, United States  \\\n",
              "0                            False                                  False   \n",
              "1                            False                                  False   \n",
              "2                            False                                  False   \n",
              "3                            False                                  False   \n",
              "4                            False                                  False   \n",
              "\n",
              "   country_Wallis and Futuna  country_Western Sahara  country_Yemen  \\\n",
              "0                      False                   False          False   \n",
              "1                      False                   False          False   \n",
              "2                      False                   False          False   \n",
              "3                      False                   False          False   \n",
              "4                      False                   False          False   \n",
              "\n",
              "   country_Zimbabwe  country_marlal  country_Åland Islands  \n",
              "0             False           False                  False  \n",
              "1             False           False                  False  \n",
              "2             False           False                  False  \n",
              "3             False           False                  False  \n",
              "4             False           False                  False  \n",
              "\n",
              "[5 rows x 216 columns]"
            ],
            "text/html": [
              "\n",
              "  <div id=\"df-b7a0aacc-d35f-4dca-be4e-daf562ea3a77\" class=\"colab-df-container\">\n",
              "    <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>gender</th>\n",
              "      <th>age</th>\n",
              "      <th>annual Salary</th>\n",
              "      <th>credit card debt</th>\n",
              "      <th>net worth</th>\n",
              "      <th>country_Afghanistan</th>\n",
              "      <th>country_Algeria</th>\n",
              "      <th>country_American Samoa</th>\n",
              "      <th>country_Andorra</th>\n",
              "      <th>country_Angola</th>\n",
              "      <th>...</th>\n",
              "      <th>country_Venezuela</th>\n",
              "      <th>country_Viet Nam</th>\n",
              "      <th>country_Virgin Islands, British</th>\n",
              "      <th>country_Virgin Islands, United States</th>\n",
              "      <th>country_Wallis and Futuna</th>\n",
              "      <th>country_Western Sahara</th>\n",
              "      <th>country_Yemen</th>\n",
              "      <th>country_Zimbabwe</th>\n",
              "      <th>country_marlal</th>\n",
              "      <th>country_Åland Islands</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>0</th>\n",
              "      <td>0</td>\n",
              "      <td>36.117247</td>\n",
              "      <td>70334.42787</td>\n",
              "      <td>9823.218967</td>\n",
              "      <td>632600.4718</td>\n",
              "      <td>False</td>\n",
              "      <td>False</td>\n",
              "      <td>False</td>\n",
              "      <td>False</td>\n",
              "      <td>False</td>\n",
              "      <td>...</td>\n",
              "      <td>False</td>\n",
              "      <td>False</td>\n",
              "      <td>False</td>\n",
              "      <td>False</td>\n",
              "      <td>False</td>\n",
              "      <td>False</td>\n",
              "      <td>False</td>\n",
              "      <td>False</td>\n",
              "      <td>False</td>\n",
              "      <td>False</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1</th>\n",
              "      <td>1</td>\n",
              "      <td>39.814817</td>\n",
              "      <td>56086.45033</td>\n",
              "      <td>6588.606462</td>\n",
              "      <td>228388.5491</td>\n",
              "      <td>False</td>\n",
              "      <td>False</td>\n",
              "      <td>False</td>\n",
              "      <td>False</td>\n",
              "      <td>False</td>\n",
              "      <td>...</td>\n",
              "      <td>False</td>\n",
              "      <td>False</td>\n",
              "      <td>False</td>\n",
              "      <td>False</td>\n",
              "      <td>False</td>\n",
              "      <td>False</td>\n",
              "      <td>False</td>\n",
              "      <td>False</td>\n",
              "      <td>False</td>\n",
              "      <td>False</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2</th>\n",
              "      <td>0</td>\n",
              "      <td>58.741842</td>\n",
              "      <td>55368.23716</td>\n",
              "      <td>13272.946470</td>\n",
              "      <td>566022.1306</td>\n",
              "      <td>False</td>\n",
              "      <td>False</td>\n",
              "      <td>False</td>\n",
              "      <td>False</td>\n",
              "      <td>False</td>\n",
              "      <td>...</td>\n",
              "      <td>False</td>\n",
              "      <td>False</td>\n",
              "      <td>False</td>\n",
              "      <td>False</td>\n",
              "      <td>False</td>\n",
              "      <td>False</td>\n",
              "      <td>False</td>\n",
              "      <td>False</td>\n",
              "      <td>False</td>\n",
              "      <td>False</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>3</th>\n",
              "      <td>0</td>\n",
              "      <td>60.180119</td>\n",
              "      <td>58837.97088</td>\n",
              "      <td>12788.815730</td>\n",
              "      <td>622324.7499</td>\n",
              "      <td>False</td>\n",
              "      <td>False</td>\n",
              "      <td>False</td>\n",
              "      <td>False</td>\n",
              "      <td>False</td>\n",
              "      <td>...</td>\n",
              "      <td>False</td>\n",
              "      <td>False</td>\n",
              "      <td>False</td>\n",
              "      <td>False</td>\n",
              "      <td>False</td>\n",
              "      <td>False</td>\n",
              "      <td>False</td>\n",
              "      <td>False</td>\n",
              "      <td>False</td>\n",
              "      <td>False</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>4</th>\n",
              "      <td>0</td>\n",
              "      <td>31.244838</td>\n",
              "      <td>41361.95045</td>\n",
              "      <td>10755.508420</td>\n",
              "      <td>615720.0425</td>\n",
              "      <td>False</td>\n",
              "      <td>False</td>\n",
              "      <td>False</td>\n",
              "      <td>False</td>\n",
              "      <td>False</td>\n",
              "      <td>...</td>\n",
              "      <td>False</td>\n",
              "      <td>False</td>\n",
              "      <td>False</td>\n",
              "      <td>False</td>\n",
              "      <td>False</td>\n",
              "      <td>False</td>\n",
              "      <td>False</td>\n",
              "      <td>False</td>\n",
              "      <td>False</td>\n",
              "      <td>False</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "<p>5 rows × 216 columns</p>\n",
              "</div>\n",
              "    <div class=\"colab-df-buttons\">\n",
              "\n",
              "  <div class=\"colab-df-container\">\n",
              "    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-b7a0aacc-d35f-4dca-be4e-daf562ea3a77')\"\n",
              "            title=\"Convert this dataframe to an interactive table.\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n",
              "    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n",
              "  </svg>\n",
              "    </button>\n",
              "\n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    .colab-df-buttons div {\n",
              "      margin-bottom: 4px;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "    <script>\n",
              "      const buttonEl =\n",
              "        document.querySelector('#df-b7a0aacc-d35f-4dca-be4e-daf562ea3a77 button.colab-df-convert');\n",
              "      buttonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "      async function convertToInteractive(key) {\n",
              "        const element = document.querySelector('#df-b7a0aacc-d35f-4dca-be4e-daf562ea3a77');\n",
              "        const dataTable =\n",
              "          await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                    [key], {});\n",
              "        if (!dataTable) return;\n",
              "\n",
              "        const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "          + ' to learn more about interactive tables.';\n",
              "        element.innerHTML = '';\n",
              "        dataTable['output_type'] = 'display_data';\n",
              "        await google.colab.output.renderOutput(dataTable, element);\n",
              "        const docLink = document.createElement('div');\n",
              "        docLink.innerHTML = docLinkHtml;\n",
              "        element.appendChild(docLink);\n",
              "      }\n",
              "    </script>\n",
              "  </div>\n",
              "\n",
              "\n",
              "    <div id=\"df-77557b06-65bb-40d0-8332-394633094fdc\">\n",
              "      <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-77557b06-65bb-40d0-8332-394633094fdc')\"\n",
              "                title=\"Suggest charts\"\n",
              "                style=\"display:none;\">\n",
              "\n",
              "<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "     width=\"24px\">\n",
              "    <g>\n",
              "        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n",
              "    </g>\n",
              "</svg>\n",
              "      </button>\n",
              "\n",
              "<style>\n",
              "  .colab-df-quickchart {\n",
              "      --bg-color: #E8F0FE;\n",
              "      --fill-color: #1967D2;\n",
              "      --hover-bg-color: #E2EBFA;\n",
              "      --hover-fill-color: #174EA6;\n",
              "      --disabled-fill-color: #AAA;\n",
              "      --disabled-bg-color: #DDD;\n",
              "  }\n",
              "\n",
              "  [theme=dark] .colab-df-quickchart {\n",
              "      --bg-color: #3B4455;\n",
              "      --fill-color: #D2E3FC;\n",
              "      --hover-bg-color: #434B5C;\n",
              "      --hover-fill-color: #FFFFFF;\n",
              "      --disabled-bg-color: #3B4455;\n",
              "      --disabled-fill-color: #666;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart {\n",
              "    background-color: var(--bg-color);\n",
              "    border: none;\n",
              "    border-radius: 50%;\n",
              "    cursor: pointer;\n",
              "    display: none;\n",
              "    fill: var(--fill-color);\n",
              "    height: 32px;\n",
              "    padding: 0;\n",
              "    width: 32px;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart:hover {\n",
              "    background-color: var(--hover-bg-color);\n",
              "    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "    fill: var(--button-hover-fill-color);\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart-complete:disabled,\n",
              "  .colab-df-quickchart-complete:disabled:hover {\n",
              "    background-color: var(--disabled-bg-color);\n",
              "    fill: var(--disabled-fill-color);\n",
              "    box-shadow: none;\n",
              "  }\n",
              "\n",
              "  .colab-df-spinner {\n",
              "    border: 2px solid var(--fill-color);\n",
              "    border-color: transparent;\n",
              "    border-bottom-color: var(--fill-color);\n",
              "    animation:\n",
              "      spin 1s steps(1) infinite;\n",
              "  }\n",
              "\n",
              "  @keyframes spin {\n",
              "    0% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "      border-left-color: var(--fill-color);\n",
              "    }\n",
              "    20% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    30% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    40% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    60% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    80% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "    90% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "  }\n",
              "</style>\n",
              "\n",
              "      <script>\n",
              "        async function quickchart(key) {\n",
              "          const quickchartButtonEl =\n",
              "            document.querySelector('#' + key + ' button');\n",
              "          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n",
              "          quickchartButtonEl.classList.add('colab-df-spinner');\n",
              "          try {\n",
              "            const charts = await google.colab.kernel.invokeFunction(\n",
              "                'suggestCharts', [key], {});\n",
              "          } catch (error) {\n",
              "            console.error('Error during call to suggestCharts:', error);\n",
              "          }\n",
              "          quickchartButtonEl.classList.remove('colab-df-spinner');\n",
              "          quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n",
              "        }\n",
              "        (() => {\n",
              "          let quickchartButtonEl =\n",
              "            document.querySelector('#df-77557b06-65bb-40d0-8332-394633094fdc button');\n",
              "          quickchartButtonEl.style.display =\n",
              "            google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "        })();\n",
              "      </script>\n",
              "    </div>\n",
              "\n",
              "    </div>\n",
              "  </div>\n"
            ],
            "application/vnd.google.colaboratory.intrinsic+json": {
              "type": "dataframe",
              "variable_name": "x_train"
            }
          },
          "metadata": {},
          "execution_count": 23
        }
      ],
      "source": [
        "x_train.head()"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "nbpVFuSiC9Rs"
      },
      "outputs": [],
      "source": [
        "categorical_cols = ['gender', 'subscription_type']\n",
        "numerical_cols = [col for col in x_train.columns if col not in categorical_cols]\n",
        "\n",
        "\n",
        "# pandas DataFrame -> torch.Tensor 변환\n",
        "x_train_tensor = torch.tensor(x_train.values, dtype=torch.float32)\n",
        "x_test_tensor  = torch.tensor(x_test.values, dtype=torch.float32)\n",
        "\n",
        "# 평균, 표준편차 계산 (학습 데이터 기준)\n",
        "mean = x_train_tensor.mean(dim=0, keepdim=True)\n",
        "std = x_train_tensor.std(dim=0, keepdim=True)\n",
        "\n",
        "# 표준화\n",
        "x_train_tensor = (x_train_tensor - mean) / std\n",
        "x_test_tensor  = (x_test_tensor - mean) / std"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "FXrspmYIDJBS"
      },
      "source": [
        "## Train"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "9_NeCjgjDHue"
      },
      "outputs": [],
      "source": [
        "#neural network class definition\n",
        "class neuralNetwork:\n",
        "\n",
        "    #initialize the neural network\n",
        "    def __init__(self, inputnodes, hiddennodes, outputnodes, learningrate):\n",
        "        #set number of nodes in each input, hidden, output layer\n",
        "        self.inodes = inputnodes\n",
        "        self.hnodes = hiddennodes\n",
        "        self.onodes = outputnodes\n",
        "\n",
        "        #가중치 행렬 wih(input_hidden)와 who(hidden_output)\n",
        "        #배열 내 가중치는 w_i_j로 표기. 노드 i에서 다음 계층의 노드 j로 연결됨을 의미\n",
        "        #w11 w21\n",
        "        #w12 w22\n",
        "\n",
        "        self.wih = np.random.normal(0.0, pow(self.hnodes, - 0.5),(self.hnodes, self.inodes))\n",
        "        self.who = np.random.normal(0.0, pow(self.onodes, - 0.5),(self.onodes, self.hnodes))\n",
        "\n",
        "        #learning rate\n",
        "        self.lr = learningrate\n",
        "\n",
        "        #expit()는 시그모이드 함수\n",
        "        self.activation_function = lambda x: scipy.special.expit(x)\n",
        "\n",
        "        pass\n",
        "\n",
        "    #신경망 학습시키기\n",
        "    def train(self, inputs_list, targets_list):\n",
        "      #입력 리스트를 2차원의 행렬로 변환\n",
        "      inputs = np.array(inputs_list, ndmin=2).T\n",
        "      targets = np.array(targets_list, ndmin=2).T\n",
        "# 순전파\n",
        "      #은닉 계층으로 들어오는 신호를 계산\n",
        "      hidden_inputs = np.dot(self.wih, inputs)\n",
        "      #은닉 계층에서 나가는 신호를 계산\n",
        "      hidden_outputs = self.activation_function(hidden_inputs)\n",
        "\n",
        "      #최종 출력 계층으로 들어오는 신호를 계산\n",
        "      final_inputs = np.dot(self.who, hidden_outputs)\n",
        "      #최종 출력 계층에서 나가는 신호를 계산\n",
        "      final_outputs = self.activation_function(final_inputs)\n",
        "\n",
        "# 역전파\n",
        "      #출력 계층의 오차는 (실제 값 - 계산 값)\n",
        "      output_errors = targets - final_outputs\n",
        "      #은닉 계층의 오차는 가중치에 의해 나뉜 계층의 오차들을 재조합해 계산\n",
        "      hidden_errors = np.dot(self.who.T, output_errors)\n",
        "# 가중치 업데이트\n",
        "      #은닉 계층과 출력 계층 간의 가중치 업데이트\n",
        "      self.who += self.lr*np.dot((output_errors*final_outputs*(1.0-final_outputs)), np.transpose(hidden_outputs))\n",
        "\n",
        "      #입력 계층과 은닉 계층 간의 가중치 업데이트\n",
        "      self.wih += self.lr*np.dot((hidden_errors*hidden_outputs*(1.0-hidden_outputs)), np.transpose(inputs))\n",
        "      pass\n",
        "\n",
        "\n",
        "    #query the neural network\n",
        "    def query(self, inputs_list):\n",
        "      #입력 리스트를 2차원 행렬로 변환\n",
        "      inputs = np.array(inputs_list, ndmin=2).T\n",
        "      #은닉 계층으로 들어오는 신호를 계산\n",
        "      #x_hidden = w_hidden x I (x는 가중치 행렬, I는 입력 값들의 행렬)\n",
        "      #입력 계층과 은닉 계층 사이의 가중치 행렬은 입력 핼렬과 조합됨\n",
        "      hidden_inputs = np.dot(self.wih, inputs)\n",
        "      #은닉 계층에서 나가는 신호를 계산\n",
        "      hidden_outputs = self.activation_function(hidden_inputs)\n",
        "      #최종 출력 계층으로 들어오는 신호 계산\n",
        "      final_inputs = np.dot(self.who, hidden_outputs)\n",
        "      #최종 출력 계층에서 나가는 신호 계산\n",
        "      final_outputs = self.activation_function(final_inputs)\n",
        "\n",
        "      return final_outputs"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "eJzk8KUaDHxX"
      },
      "outputs": [],
      "source": [
        "#입력, 은닉, 출력 노드의 수\n",
        "input_nodes = 8\n",
        "hidden_nodes = 10\n",
        "output_nodes = 3\n",
        "\n",
        "#학습률은 0.3\n",
        "learning_rate = 0.1\n",
        "\n",
        "#인경망의 인스턴스(instance)를 생성\n",
        "n = neuralNetwork(input_nodes, hidden_nodes, output_nodes, learning_rate)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "mFj7r2-BDICh",
        "outputId": "aa59d26d-d029-4a65-9174-560f6bb16662"
      },
      "outputs": [
        {
          "ename": "ValueError",
          "evalue": "shapes (10,8) and (6,1) not aligned: 8 (dim 1) != 6 (dim 0)",
          "output_type": "error",
          "traceback": [
            "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
            "\u001b[0;31mValueError\u001b[0m                                Traceback (most recent call last)",
            "Cell \u001b[0;32mIn[37], line 7\u001b[0m\n\u001b[1;32m      5\u001b[0m     inputs \u001b[38;5;241m=\u001b[39m x_train_tensor[i]\u001b[38;5;241m.\u001b[39mnumpy()\n\u001b[1;32m      6\u001b[0m     targets \u001b[38;5;241m=\u001b[39m y_train_onehot[i]\u001b[38;5;241m.\u001b[39mnumpy()   \u001b[38;5;66;03m# y_train도 torch.Tensor라면 변환 필요\u001b[39;00m\n\u001b[0;32m----> 7\u001b[0m     \u001b[43mn\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mtrain\u001b[49m\u001b[43m(\u001b[49m\u001b[43minputs\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mtargets\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m      9\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m e \u001b[38;5;241m%\u001b[39m \u001b[38;5;241m10\u001b[39m \u001b[38;5;241m==\u001b[39m \u001b[38;5;241m0\u001b[39m:\n\u001b[1;32m     10\u001b[0m     \u001b[38;5;28mprint\u001b[39m(\u001b[38;5;124mf\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mepoch: \u001b[39m\u001b[38;5;132;01m{\u001b[39;00me\u001b[38;5;132;01m}\u001b[39;00m\u001b[38;5;124m\"\u001b[39m)\n",
            "Cell \u001b[0;32mIn[33], line 34\u001b[0m, in \u001b[0;36mneuralNetwork.train\u001b[0;34m(self, inputs_list, targets_list)\u001b[0m\n\u001b[1;32m     31\u001b[0m       targets \u001b[38;5;241m=\u001b[39m np\u001b[38;5;241m.\u001b[39marray(targets_list, ndmin\u001b[38;5;241m=\u001b[39m\u001b[38;5;241m2\u001b[39m)\u001b[38;5;241m.\u001b[39mT\n\u001b[1;32m     32\u001b[0m \u001b[38;5;66;03m# 순전파\u001b[39;00m\n\u001b[1;32m     33\u001b[0m       \u001b[38;5;66;03m#은닉 계층으로 들어오는 신호를 계산\u001b[39;00m\n\u001b[0;32m---> 34\u001b[0m       hidden_inputs \u001b[38;5;241m=\u001b[39m \u001b[43mnp\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mdot\u001b[49m\u001b[43m(\u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mwih\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43minputs\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m     35\u001b[0m       \u001b[38;5;66;03m#은닉 계층에서 나가는 신호를 계산\u001b[39;00m\n\u001b[1;32m     36\u001b[0m       hidden_outputs \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mactivation_function(hidden_inputs)\n",
            "\u001b[0;31mValueError\u001b[0m: shapes (10,8) and (6,1) not aligned: 8 (dim 1) != 6 (dim 0)"
          ]
        }
      ],
      "source": [
        "epochs = 10\n",
        "for e in range(epochs):\n",
        "    for i in range(len(x_train_tensor)):\n",
        "        # torch.Tensor -> numpy 변환\n",
        "        inputs = x_train_tensor[i].numpy()\n",
        "        targets = y_train_onehot[i].numpy()   # y_train도 torch.Tensor라면 변환 필요\n",
        "        n.train(inputs, targets)\n",
        "\n",
        "    if e % 10 == 0:\n",
        "        print(f\"epoch: {e}\")"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "PiQuyz4b4CBl"
      },
      "source": [
        "## Prediction"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "MJjhjPUy41rQ",
        "outputId": "6fb7eaad-06cf-4be5-a968-d9d7ed34dcb1"
      },
      "outputs": [
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "0\n"
          ]
        }
      ],
      "source": [
        "submission_csv = pd.read_csv('sample_submission.csv')\n",
        "submission=submission_csv['support_needs']\n",
        "print(submission[0])"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "e67l5C_hAR03",
        "outputId": "0cb93058-56be-44b1-b802-c81ceaf9e6d9"
      },
      "outputs": [
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "저장 완료: baseline_submit.csv\n"
          ]
        }
      ],
      "source": [
        "import numpy as np\n",
        "import pandas as pd\n",
        "\n",
        "preds = []\n",
        "for i in range(len(x_test)):\n",
        "    inputs = x_test.iloc[i].values\n",
        "    outputs = n.query(inputs)           # shape (3,1)\n",
        "    label = np.argmax(outputs)          # 가장 큰 값의 index = 클래스 예측\n",
        "    preds.append(label)\n",
        "\n",
        "# DataFrame에 예측값 저장\n",
        "submission = pd.read_csv('sample_submission.csv')\n",
        "submission['support_needs'] = preds\n",
        "submission.to_csv('baseline_submit.csv', index=False)\n",
        "\n",
        "print(\"저장 완료: baseline_submit.csv\")\n"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "0dqc05iF4KF0"
      },
      "source": [
        "## Submission"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "2Q8gEeCm42j7"
      },
      "outputs": [],
      "source": []
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "wimUj8x54NgQ"
      },
      "outputs": [],
      "source": []
    }
  ],
  "metadata": {
    "accelerator": "GPU",
    "colab": {
      "gpuType": "T4",
      "provenance": [],
      "include_colab_link": true
    },
    "kernelspec": {
      "display_name": "Python 3 (ipykernel)",
      "language": "python",
      "name": "python3"
    },
    "language_info": {
      "codemirror_mode": {
        "name": "ipython",
        "version": 3
      },
      "file_extension": ".py",
      "mimetype": "text/x-python",
      "name": "python",
      "nbconvert_exporter": "python",
      "pygments_lexer": "ipython3",
      "version": "3.10.8"
    }
  },
  "nbformat": 4,
  "nbformat_minor": 0
}